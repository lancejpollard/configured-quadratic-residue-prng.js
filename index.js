
const permute = require('@lancejpollard/quadratic-residue-prng.js')

const MAX = size => BigInt(Math.pow(256, size / 4))

// String(256 ** 4).match(/.{1,3}/g).join(',')

const MAP = {
  256: { // 13407807929942597099574024998205846127479365820592393377723561443721764030073546976801874298166903427690031858186486050853753882811946569946433649006084096
    E: 7994412097716110548127211733331600522933776757046707649963673962686200838432950239103981070728369599816314646482720706826018360181196843154224748382211019n,
    O: 7777777777777777777777777777777777777778777777777777777777777777777777777777777n,
    U: MAX(256)
  },
  128: { // 115,792,089,237,316,195,423,570,985,008,687,907,853,269,984,665,640,564,039,457,584,007,913,129,639,936
    E: 79999999999999999999999999999999999999999999999999999999999999999999999999999n,
    O: 503509521523541547557563569571577587593599n,
    U: MAX(128)
  },
  96: { // 6,277,101,735,386,680,763,835,789,423,207,666,416,102,355,444,464,034,512,896
    E: 1011031071091113171922329313374143475355961677173797798983n,
    O: 11111177777555555533333333333n,
    U: MAX(96)
  },
  64: { // 340,282,366,920,938,463,463,374,607,431,768,211,456
    E: 237512715131811281324243117391942323623n,
    O: 5555555555555555555519n,
    U: MAX(64)
  },
  36: { // 4,722,366,482,869,645,213,696
    E: 3895126220983308449519n,
    O: 1110111110111n,
    U: MAX(36)
  },
  32: { // 18,446,744,073,709,552,000
    E: 16808980088116168811n,
    O: 66666666667n,
    U: MAX(32),
  },
  28: { // 72,057,594,037,927,940
    E: 70000006660000007n,
    O: 4332221111n,
    U: MAX(28)
  },
  24: { // 281,474,976,710,656
    E: 274988895429719n,
    O: 118818811n,
    U: MAX(24)
  },
  20: { // 1,099,511,627,776
    E: 1049179854847n,
    O: 96545899n,
    U: MAX(20)
  },
  16: { // 4,294,967,296
    E: 4294967291n,
    O: 264083n,
    U: MAX(16)
  },
  12: { // 16,777,216
    E: 16769023n,
    O: 7333n,
    U: MAX(12),
  },
  8: { // 65,536
    E: 64951n,
    O: 209n,
    U: MAX(8),
  },
  4: { // 256
    E: 251n,
    O: 103n,
    U: MAX(4),
  }
}

module.exports = resolve

function resolve(i, j, size) {
  const { E, O, U } = MAP[size]
  const x = permute(i++, E, j, O, U)
  return x
}
